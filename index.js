export function $c(tagName, attributes, children) {
    const el = document.createElement(tagName);

    if (attributes !== undefined) {
        for (const [attribute, value] of Object.entries(attributes)) {
            if (attribute === "textContent") {
                el.textContent = value;
            } else if (attribute === "innerHTML") {
                el.innerHTML = value;
            } else if (attribute === "classList") {
                value.forEach((className) => {
                    el.classList.add(className);
                });
            } else {
                el.setAttribute(attribute, value);
            }
        }
    }

    if (children !== undefined) {
        children.map((c) => {
            el.appendChild(c);
        });
    }

    return el;
}

export function $a(el, children) {
    children.map((child) => {
        el.appendChild(child);
    });
}

const header = document.querySelector("header");
const footer = document.querySelector("footer");

const urls = {
    email: "mailto:safe.key1974@fastmail.com",
    github: "https://github.com/manskron",
    linkedin: "https://www.linkedin.com/in/mansbrusback/",
};

const pages = {
    home: "/",
    cells: "/pages/cells.html",
    emacsConf: "/pages/emacsconf.html",
};

const logo = `
<svg viewBox="0 0 201 94" fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path class="text" d="M11.122 45.7691C10.362 45.7691 9.66533 45.6804 9.032 45.5031C8.424 45.3511 7.87933 45.1484 7.398 44.8951C6.942 44.6164 6.54933 44.3251 6.22 44.0211C5.916 43.6918 5.688 43.3878 5.536 43.1091H5.384V45.3131H0.976V37.5611H5.384V39.1951C5.384 40.5631 5.86533 41.5384 6.828 42.1211C7.79067 42.6784 9.108 42.9571 10.78 42.9571C12.528 42.9571 13.82 42.6024 14.656 41.8931C15.5173 41.1838 15.948 40.2591 15.948 39.1191C15.948 38.5618 15.872 38.0804 15.72 37.6751C15.5933 37.2698 15.3653 36.9278 15.036 36.6491C14.7067 36.3451 14.2633 36.0918 13.706 35.8891C13.1487 35.6611 12.452 35.4584 11.616 35.2811L9.906 34.9011C8.614 34.6478 7.42333 34.3058 6.334 33.8751C5.27 33.4191 4.358 32.8364 3.598 32.1271C2.838 31.4178 2.24267 30.5691 1.812 29.5811C1.40667 28.5931 1.204 27.4278 1.204 26.0851C1.204 24.9451 1.40667 23.9064 1.812 22.9691C2.21733 22.0064 2.8 21.1831 3.56 20.4991C4.32 19.8151 5.25733 19.2831 6.372 18.9031C7.512 18.5231 8.804 18.3331 10.248 18.3331C11.0333 18.3331 11.73 18.4218 12.338 18.5991C12.9713 18.7511 13.516 18.9538 13.972 19.2071C14.4533 19.4604 14.846 19.7518 15.15 20.0811C15.454 20.3851 15.682 20.6764 15.834 20.9551H15.986V18.7891H20.394V26.5411H15.986V24.8691C15.986 23.5264 15.5173 22.5764 14.58 22.0191C13.6427 21.4364 12.4267 21.1451 10.932 21.1451C9.20933 21.1451 7.94267 21.5124 7.132 22.2471C6.34667 22.9564 5.954 23.8178 5.954 24.8311C5.954 25.4138 6.04267 25.9078 6.22 26.3131C6.39733 26.7184 6.676 27.0731 7.056 27.3771C7.46133 27.6811 7.98067 27.9471 8.614 28.1751C9.24733 28.3778 10.02 28.5804 10.932 28.7831L12.528 29.0871C13.8453 29.3658 15.0233 29.7331 16.062 30.1891C17.126 30.6198 18.0127 31.1771 18.722 31.8611C19.4567 32.5451 20.014 33.3558 20.394 34.2931C20.774 35.2051 20.964 36.2691 20.964 37.4851C20.964 38.6758 20.736 39.7778 20.28 40.7911C19.824 41.8044 19.1653 42.6784 18.304 43.4131C17.468 44.1478 16.442 44.7304 15.226 45.1611C14.01 45.5664 12.642 45.7691 11.122 45.7691ZM22.6883 42.8051H24.5883L32.8343 18.7891H38.0783L46.3243 42.8051H48.2243V45.3131H37.0903V42.8051H40.1303L38.3063 37.2191H29.6423L27.8183 42.8051H30.8583V45.3131H22.6883V42.8051ZM30.4023 34.5971H37.6223L34.0503 23.4251H33.8983L30.4023 34.5971ZM50.2846 42.8051H52.9446V21.2971H50.2846V18.7891H60.5446L71.4126 37.6751H71.6406V21.2971H68.9806V18.7891H77.2266V21.2971H74.6046V45.3131H69.0566L56.1366 23.2351H55.9086V42.8051H58.5686V45.3131H50.2846V42.8051ZM80.3432 42.8051H83.0032V21.2971H80.3432V18.7891H92.7312C94.5552 18.7891 96.2398 19.0931 97.7852 19.7011C99.3558 20.2838 100.711 21.1451 101.851 22.2851C102.991 23.3998 103.878 24.7804 104.511 26.4271C105.17 28.0738 105.499 29.9484 105.499 32.0511C105.499 34.1538 105.17 36.0284 104.511 37.6751C103.878 39.3218 102.991 40.7151 101.851 41.8551C100.711 42.9698 99.3558 43.8311 97.7852 44.4391C96.2398 45.0218 94.5552 45.3131 92.7312 45.3131H80.3432V42.8051ZM89.1592 42.5771H91.6292C92.8958 42.5771 93.9725 42.4504 94.8592 42.1971C95.7712 41.9438 96.5058 41.5511 97.0632 41.0191C97.6458 40.4618 98.0638 39.7398 98.3172 38.8531C98.5958 37.9411 98.7352 36.8391 98.7352 35.5471V28.5551C98.7352 27.2631 98.5958 26.1738 98.3172 25.2871C98.0638 24.3751 97.6458 23.6531 97.0632 23.1211C96.5058 22.5638 95.7712 22.1584 94.8592 21.9051C93.9725 21.6518 92.8958 21.5251 91.6292 21.5251H89.1592V42.5771ZM106.852 42.8051H108.752L116.998 18.7891H122.242L130.488 42.8051H132.388V45.3131H121.254V42.8051H124.294L122.47 37.2191H113.806L111.982 42.8051H115.022V45.3131H106.852V42.8051ZM114.566 34.5971H121.786L118.214 23.4251H118.062L114.566 34.5971ZM145.534 45.7691C143.634 45.7691 141.95 45.4271 140.48 44.7431C139.036 44.0338 137.808 43.0711 136.794 41.8551C135.781 40.6138 135.008 39.1571 134.476 37.4851C133.97 35.8131 133.716 34.0144 133.716 32.0891C133.716 29.8598 134.02 27.8838 134.628 26.1611C135.262 24.4384 136.098 23.0071 137.136 21.8671C138.175 20.7018 139.378 19.8278 140.746 19.2451C142.14 18.6371 143.584 18.3331 145.078 18.3331C145.889 18.3331 146.598 18.4218 147.206 18.5991C147.84 18.7511 148.384 18.9538 148.84 19.2071C149.296 19.4604 149.676 19.7518 149.98 20.0811C150.284 20.3851 150.512 20.6891 150.664 20.9931H150.892V18.7891H155.3V27.2251H150.892V25.5151C150.892 24.2231 150.462 23.1844 149.6 22.3991C148.764 21.6138 147.536 21.2211 145.914 21.2211C144.217 21.2211 142.887 21.7531 141.924 22.8171C140.962 23.8811 140.48 25.5531 140.48 27.8331V35.5471C140.48 36.7378 140.632 37.7511 140.936 38.5871C141.24 39.4231 141.658 40.1198 142.19 40.6771C142.748 41.2344 143.394 41.6398 144.128 41.8931C144.888 42.1464 145.712 42.2731 146.598 42.2731C148.22 42.2731 149.588 41.8551 150.702 41.0191C151.842 40.1578 152.704 39.0051 153.286 37.5611L155.452 38.8151C155.123 39.7778 154.654 40.6898 154.046 41.5511C153.438 42.3871 152.704 43.1218 151.842 43.7551C151.006 44.3884 150.056 44.8824 148.992 45.2371C147.928 45.5918 146.776 45.7691 145.534 45.7691ZM158.57 42.8051H161.23V21.2971H158.57V18.7891H170.046V21.2971H167.386V30.3031H177.494V21.2971H174.834V18.7891H186.31V21.2971H183.65V42.8051H186.31V45.3131H174.834V42.8051H177.494V33.0391H167.386V42.8051H170.046V45.3131H158.57V42.8051ZM189.408 42.8051H192.068V21.2971H189.408V18.7891H200.884V21.2971H198.224V42.8051H200.884V45.3131H189.408V42.8051Z" fill="#464555"/>
    <rect x="25.0356" y="55.3131" width="151.929" height="2.37389" rx="1" fill="#4A68D9"/>
    <path class="text" d="M79.866 81.9629C78.854 81.9629 77.934 81.7712 77.106 81.3879C76.278 81.0046 75.5727 80.4526 74.99 79.7319C74.4073 79.0112 73.955 78.1372 73.633 77.1099C73.311 76.0826 73.15 74.9326 73.15 73.6599C73.15 72.3259 73.311 71.1452 73.633 70.1179C73.955 69.0906 74.3997 68.2242 74.967 67.5189C75.5497 66.8136 76.2473 66.2769 77.06 65.9089C77.8727 65.5409 78.7697 65.3569 79.751 65.3569C80.7477 65.3569 81.5757 65.5256 82.235 65.8629C82.9097 66.1849 83.3543 66.5912 83.569 67.0819H83.661V65.6329H85.317V70.3249H83.661V69.1289C83.661 68.3622 83.3237 67.7489 82.649 67.2889C81.9743 66.8136 81.0927 66.5759 80.004 66.5759C79.1913 66.5759 78.486 66.7292 77.888 67.0359C77.3053 67.3272 76.8223 67.7336 76.439 68.2549C76.071 68.7609 75.795 69.3589 75.611 70.0489C75.4423 70.7236 75.358 71.4366 75.358 72.1879V74.9709C75.358 75.8142 75.4653 76.5732 75.68 77.2479C75.91 77.9226 76.232 78.5052 76.646 78.9959C77.0753 79.4712 77.5967 79.8392 78.21 80.0999C78.8233 80.3606 79.521 80.4909 80.303 80.4909C81.3917 80.4909 82.304 80.2072 83.04 79.6399C83.776 79.0726 84.3127 78.3519 84.65 77.4779L85.547 77.9149C85.409 78.3596 85.1867 78.8196 84.88 79.2949C84.5733 79.7702 84.1823 80.2072 83.707 80.6059C83.247 81.0046 82.695 81.3342 82.051 81.5949C81.407 81.8402 80.6787 81.9629 79.866 81.9629ZM93.1979 80.8359C93.7652 80.8359 94.2559 80.7439 94.6699 80.5599C95.0992 80.3606 95.4442 80.0922 95.7049 79.7549C95.9809 79.4022 96.1802 78.9959 96.3029 78.5359C96.4409 78.0606 96.5099 77.5469 96.5099 76.9949V74.5109C96.5099 73.9589 96.4409 73.4529 96.3029 72.9929C96.1802 72.5176 95.9809 72.1112 95.7049 71.7739C95.4442 71.4212 95.0992 71.1529 94.6699 70.9689C94.2559 70.7696 93.7652 70.6699 93.1979 70.6699C92.6152 70.6699 92.1169 70.7696 91.7029 70.9689C91.2889 71.1529 90.9439 71.4212 90.6679 71.7739C90.4072 72.1112 90.2079 72.5176 90.0699 72.9929C89.9472 73.4529 89.8859 73.9589 89.8859 74.5109V76.9949C89.8859 77.5469 89.9472 78.0606 90.0699 78.5359C90.2079 78.9959 90.4072 79.4022 90.6679 79.7549C90.9439 80.0922 91.2889 80.3606 91.7029 80.5599C92.1169 80.7439 92.6152 80.8359 93.1979 80.8359ZM93.1979 81.9629C92.3852 81.9629 91.6416 81.8172 90.9669 81.5259C90.2922 81.2346 89.7172 80.8206 89.2419 80.2839C88.7666 79.7319 88.3986 79.0802 88.1379 78.3289C87.8772 77.5622 87.7469 76.7036 87.7469 75.7529C87.7469 74.8176 87.8772 73.9666 88.1379 73.1999C88.3986 72.4332 88.7666 71.7816 89.2419 71.2449C89.7172 70.6929 90.2922 70.2712 90.9669 69.9799C91.6416 69.6886 92.3852 69.5429 93.1979 69.5429C94.0106 69.5429 94.7542 69.6886 95.4289 69.9799C96.1036 70.2712 96.6786 70.6929 97.1539 71.2449C97.6292 71.7816 97.9972 72.4332 98.2579 73.1999C98.5186 73.9666 98.6489 74.8176 98.6489 75.7529C98.6489 76.7036 98.5186 77.5622 98.2579 78.3289C97.9972 79.0802 97.6292 79.7319 97.1539 80.2839C96.6786 80.8206 96.1036 81.2346 95.4289 81.5259C94.7542 81.8172 94.0106 81.9629 93.1979 81.9629ZM100.844 80.6289H102.546V71.3139L100.844 71.0149V70.2329L104.386 69.5429V71.6129H104.501C104.609 71.3676 104.739 71.1222 104.892 70.8769C105.061 70.6316 105.26 70.4092 105.49 70.2099C105.736 70.0106 106.012 69.8496 106.318 69.7269C106.64 69.6042 107.008 69.5429 107.422 69.5429C108.097 69.5429 108.634 69.7039 109.032 70.0259C109.446 70.3479 109.653 70.8156 109.653 71.4289C109.653 71.8889 109.538 72.2492 109.308 72.5099C109.078 72.7706 108.779 72.9009 108.411 72.9009C107.997 72.9009 107.668 72.7936 107.422 72.5789C107.177 72.3489 107.054 72.0576 107.054 71.7049C107.054 71.3982 107.116 71.1529 107.238 70.9689C107.376 70.7696 107.53 70.6546 107.698 70.6239V70.5779C107.637 70.5626 107.56 70.5549 107.468 70.5549C107.376 70.5396 107.261 70.5319 107.123 70.5319C106.801 70.5319 106.479 70.6162 106.157 70.7849C105.835 70.9382 105.544 71.1452 105.283 71.4059C105.038 71.6512 104.831 71.9349 104.662 72.2569C104.509 72.5789 104.432 72.9009 104.432 73.2229V80.6289H106.594V81.6869H100.844V80.6289ZM110.812 85.2289H112.514V71.3139L110.812 71.0149V70.2329L114.4 69.5429V71.6129H114.492C114.752 71.0456 115.166 70.5626 115.734 70.1639C116.301 69.7499 117.052 69.5429 117.988 69.5429C119.46 69.5429 120.633 70.0796 121.507 71.1529C122.396 72.2109 122.841 73.7442 122.841 75.7529C122.841 77.7616 122.396 79.3026 121.507 80.3759C120.633 81.4339 119.46 81.9629 117.988 81.9629C117.068 81.9629 116.316 81.7636 115.734 81.3649C115.166 80.9662 114.752 80.4832 114.492 79.9159H114.4V85.2289H116.562V86.2869H110.812V85.2289ZM117.436 80.6519C118.494 80.6519 119.314 80.2992 119.897 79.5939C120.495 78.8732 120.794 77.9149 120.794 76.7189V74.7869C120.794 73.5909 120.495 72.6402 119.897 71.9349C119.314 71.2142 118.494 70.8539 117.436 70.8539C117.068 70.8539 116.7 70.9076 116.332 71.0149C115.964 71.1222 115.634 71.2756 115.343 71.4749C115.067 71.6742 114.837 71.9272 114.653 72.2339C114.484 72.5252 114.4 72.8549 114.4 73.2229V78.2829C114.4 78.6509 114.484 78.9882 114.653 79.2949C114.837 79.5862 115.067 79.8316 115.343 80.0309C115.634 80.2302 115.964 80.3836 116.332 80.4909C116.7 80.5982 117.068 80.6519 117.436 80.6519ZM126.383 81.9629C125.938 81.9629 125.585 81.8326 125.325 81.5719C125.079 81.2959 124.957 80.9662 124.957 80.5829V80.4449C124.957 80.0616 125.079 79.7396 125.325 79.4789C125.585 79.2029 125.938 79.0649 126.383 79.0649C126.827 79.0649 127.172 79.2029 127.418 79.4789C127.678 79.7396 127.809 80.0616 127.809 80.4449V80.5829C127.809 80.9662 127.678 81.2959 127.418 81.5719C127.172 81.8326 126.827 81.9629 126.383 81.9629Z" fill="#464555"/>
</svg>

`;

const menuIcon = `
<svg xmlns="http://www.w3.org/2000/svg" fill="#f00000" viewBox="0 0 256 256"><path d="M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128ZM40,70H216a6,6,0,0,0,0-12H40a6,6,0,0,0,0,12ZM216,186H40a6,6,0,0,0,0,12H216a6,6,0,0,0,0-12Z"></path></svg>
`;

const lightIcon = `
<svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="#f00000" viewBox="0 0 256 256"><path d="M122,40V16a6,6,0,0,1,12,0V40a6,6,0,0,1-12,0Zm68,88a62,62,0,1,1-62-62A62.07,62.07,0,0,1,190,128Zm-12,0a50,50,0,1,0-50,50A50.06,50.06,0,0,0,178,128ZM59.76,68.24a6,6,0,1,0,8.48-8.48l-16-16a6,6,0,0,0-8.48,8.48Zm0,119.52-16,16a6,6,0,1,0,8.48,8.48l16-16a6,6,0,1,0-8.48-8.48ZM192,70a6,6,0,0,0,4.24-1.76l16-16a6,6,0,0,0-8.48-8.48l-16,16A6,6,0,0,0,192,70Zm4.24,117.76a6,6,0,0,0-8.48,8.48l16,16a6,6,0,0,0,8.48-8.48ZM46,128a6,6,0,0,0-6-6H16a6,6,0,0,0,0,12H40A6,6,0,0,0,46,128Zm82,82a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V216A6,6,0,0,0,128,210Zm112-88H216a6,6,0,0,0,0,12h24a6,6,0,0,0,0-12Z"></path></svg>
`;

const darkIcon = `
<svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" fill="#f00000" viewBox="0 0 256 256"><path d="M232.13,143.64a6,6,0,0,0-6-1.49A90.07,90.07,0,0,1,113.86,29.85a6,6,0,0,0-7.49-7.48A102.88,102.88,0,0,0,54.48,58.68,102,102,0,0,0,197.32,201.52a102.88,102.88,0,0,0,36.31-51.89A6,6,0,0,0,232.13,143.64Zm-42,48.29a90,90,0,0,1-126-126A90.9,90.9,0,0,1,99.65,37.66,102.06,102.06,0,0,0,218.34,156.35,90.9,90.9,0,0,1,190.1,191.93Z"></path></svg>
`;

$a(header, [
    $c("button", { innerHTML: menuIcon, id: "menu-button" }),
    $c("a", {
        id: "logo-link",
        href: "/",
        "aria-label": "Go to startpage",
        innerHTML: logo,
    }),
    $c("button", {
        type: "button",
        id: "theme-button",
    }),
]);

$a(footer, [
    $c("div", { id: "footer-links" }, [
        $c("a", { href: urls.email, textContent: "Email" }),
        $c("a", { href: urls.github, textContent: "Github" }),
        $c("a", { href: urls.linkedin, textContent: "LinkedIn" }),
    ]),
    $c("div", { id: "footer-copyline" }, [
        $c("i", { textContent: "Â© 1978 SANDACHI Corporation" }),
    ]),
]);

(function setupThemeButton() {
    const btn = document.getElementById("theme-button");
    const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");

    const currentTheme = localStorage.getItem("theme");

    if (!currentTheme) {
        btn.innerHTML = document.body.classList.contains("light-theme")
            ? lightIcon
            : lightIcon;
    }

    if (currentTheme == "dark") {
        document.body.classList.toggle("dark-theme");
        btn.innerHTML = lightIcon;
    } else if (currentTheme == "light") {
        document.body.classList.toggle("light-theme");
        btn.innerHTML = darkIcon;
    }

    btn.addEventListener("click", function () {
        if (btn.innerHTML == lightIcon) {
            btn.innerHTML = darkIcon;
        } else {
            btn.innerHTML = lightIcon;
        }

        if (prefersDarkScheme.matches) {
            document.body.classList.toggle("light-theme");
            var theme = document.body.classList.contains("light-theme")
                ? "light"
                : "dark";
        } else {
            document.body.classList.toggle("dark-theme");
            var theme = document.body.classList.contains("dark-theme")
                ? "dark"
                : "light";
        }
        localStorage.setItem("theme", theme);
    });
})();

(function setupMenuButton() {
    const btn = document.getElementById("menu-button");
    const menuContainer = document.getElementById("menu-container");

    btn.addEventListener("click", () => {
        menuContainer.classList.toggle("visible");
        console.log("clicked menu button");
    });
})();

(function setupMenuCloseButton() {
    const btn = document.getElementById("menu-close-button");
    const menuContainer = document.getElementById("menu-container");

    btn.addEventListener("click", () => {
        menuContainer.classList.toggle("visible");
        console.log("clicked menu button");
    });
})();
